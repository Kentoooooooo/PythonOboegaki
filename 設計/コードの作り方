ğŸ”µè‰¯ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã£ã¦ï¼Ÿ
ãƒ»ã©ã“ã§ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹èª­ã¿ã«ãã„ ï¼ï¼ å¯èª­æ€§ãŒä½ã„
ãƒ»ä¿®æ­£ãŒã—ã«ãã„ã€‚1ç®‡æ‰€ä¿®æ­£ã™ã‚‹ã¨ã„ã‚ã„ã‚ãªå ´æ‰€ã§å‹•ã‹ãªããªã‚‹ ï¼ï¼ ä¿å®ˆæ€§ãŒä½ã„
ãƒ»éå‰°ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦é–‰ã˜ã¦ã„ã‚‹


ğŸ”µã‚³ãƒ¼ãƒ‰ã‚’ã‚­ãƒ¬ã‚¤ã«æ›¸ãæ–¹æ³•
ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
import os


def main():
    # å•†å“ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
    items = {}
    with open('input/items.csv', encoding='utf-8') as f:
        for row in f:
            data = row.rstrip().split(',')
            item_id = data[0]
            name = data[1]
            price = data[2]
            items[item_id] = {
                'name': name,
                'price': price
            }

    with open('output/sales.csv', mode='w', encoding='utf-8') as sales_f:
        for name in os.listdir('input/'):
            if name.startswith('sales_raw_') and name.endswith('.csv') \
                    and "201611" in name:
                with open(os.path.join('input/', name), encoding='utf-8') as f:
                    for row in f:
                        data = row.rstrip().split(',')
                        item_id = data[2]
                        if item_id in items:
                            sales_f.write(
                                ','.join((
                                    data[0],
                                    data[1],
                                    data[2],
                                    items[item_id]['name'],
                                    items[item_id]['price'],
                                    data[3],
                                    data[4],
                                )) + '\n'
                            )


if __name__ == "__main__":
    main()
ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

ğŸ”µã¾ãšåˆã‚ã®å‡¦ç†ã¨ã—ã¦CSVã®ãƒ‡ãƒ¼ã‚¿ã‚’è¾æ›¸ã«å…¥ã‚Œã¦ã„ã‚‹

items[item_id] = {
  'name': name,
  'price': price
}
â€» è¾æ›¸ã®å€¤ã¨ã—ã¦ã€ã•ã‚‰ã«è¾æ›¸ã‚’å…¥ã‚Œã¦ã„ã‚‹ã€‚

ğŸ”µItemsè¾æ›¸ã‚’ä½¿ã£ã¦å•†å“ã®å–ã‚Šå‡ºã—
